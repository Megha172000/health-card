<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Material Design Bootstrap</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="/css/mdb.min.css" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link href="/css/style.min.css" rel="stylesheet">
    <style>
        .map-container{
            overflow:hidden;
            padding-bottom:56.25%;
            position:relative;
            height:0;
        }
        .map-container iframe{
            left:0;
            top:0;
            height:100%;
            width:100%;
            position:absolute;
        }
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
        }
        .pagination-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        .pagination-controls i {
            font-size: 1.5em;
            color: #6c757d; /* or any color you prefer */
        }

        .pagination-controls i:hover {
            color: #264488; /* or any hover color you prefer */
        }
        .pagination-controls .disabled {
            color: #ccc; /* Or any other color indicating disabled state */
            pointer-events: none; /* Prevent any interaction with the icon */
            cursor: default; /* Change cursor to indicate non-clickable state */
        }
        .btn.teal-color-button,
        .btn.teal-color-button:hover,
        .btn.teal-color-button:focus,
        .btn.teal-color-button:active,
        .btn.teal-color-button:active:focus {
            background-color: teal !important;
            border-color: teal !important;
            color: #fff !important; /* Ensures text remains visible */
        }
        .primary-color-dark,
        .list-group-item.active{
            background-color: teal !important;
        }
        .teal-text{
            color: teal !important;
        }
        /* Loader styles */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s ease;
            opacity: 0;
            visibility: hidden;
        }
        .loader.active {
            opacity: 1;
            visibility: visible;
        }
        .loader .spinner-border {
            width: 3rem;
            height: 3rem;
            border-width: 0.3em;
        }
        .sidebar-fixed .logo-wrapper img {
            max-height: 105px;
        }

    </style>
</head>
<body class="grey lighten-3">
<!--Main Navigation-->
<header>
    <!-- Navbar -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-light white scrolling-navbar">
        <div class="container-fluid">
            <!-- Brand -->
            <a class="navbar-brand waves-effect" href="#" target="_blank">
                <strong class="teal-text">Home</strong>
            </a>
            <!-- Collapse -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Links -->
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <!-- Left -->
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link waves-effect" id="navBarHospitalScroll" href="#hospitalTable">Hospitals
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link waves-effect" id="navBarAgentScroll" href="#agentTable" target="_blank">Agents</a>
                    </li>
                </ul>
                <!-- Right -->
                <ul class="navbar-nav nav-flex-icons">
                    <li class="nav-item">
                        <a href="https://www.facebook.com/mdbootstrap" class="nav-link waves-effect" target="_blank">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="https://twitter.com/MDBootstrap" class="nav-link waves-effect" target="_blank">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Navbar -->
    <!-- Sidebar -->
    <div class="sidebar-fixed position-fixed">
        <a class="logo-wrapper waves-effect" style="padding-bottom: 20px;">
            <img src="/images/logo2.png" class="img-fluid" alt="">
        </a>
        <div class="list-group list-group-flush">
            <a href="#" class="list-group-item active waves-effect">
                <i class="fas fa-chart-pie mr-3"></i>Dashboard
            </a>
            <a href="#agentTable" class="list-group-item list-group-item-action waves-effect" id="scrollToAgentTable">
                <i class="fas fa-table mr-3"></i>Agents</a>
            <a href="#hospitalTable" class="list-group-item list-group-item-action waves-effect" id="scrollToTable">
                <i class="fas fa-user mr-3"></i>Hospitals</a>
        </div>
    </div>
    <!-- Sidebar -->
</header>
<!--Main Navigation-->
<!--Main layout-->
<main class="pt-5 mx-lg-5">
    <div class="container-fluid mt-5">
        <!-- Heading -->
        <div class="card mb-4 wow fadeIn">
            <!--Card content-->
            <div class="card-body d-sm-flex justify-content-between">
                <h4 class="mb-2 mb-sm-0 pt-1">
                    <span id="welcomeDisplay">Welcome Admin,</span>
                </h4>
                <form class="d-flex justify-content-center">
                    <!-- Default input -->
                    <input type="search" placeholder="Type your query" aria-label="Search" class="form-control">
                    <button class="btn btn-primary btn-sm my-0 p teal-color-button" type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
            </div>
        </div>
        <!-- Heading -->
        <!--Grid row-->
        <div class="row wow fadeIn">
            <!--Grid column-->
            <div class="col-md-9 mb-4">
                <!--Card-->
                <div class="card">
                    <!--Card content-->
                    <div class="card-body">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
                <!--/.Card-->
            </div>
            <!--Grid column-->
            <!--Grid column-->
            <div class="col-md-3 mb-4">
                <!--Card-->
                <div class="card mb-4">
                    <!-- Card header -->
                    <div class="card-header text-center">
                        Pie chart
                    </div>
                    <!--Card content-->
                    <div class="card-body">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
                <!--/.Card-->
                <!--Card-->
                <div class="card mb-4">
                    <!--Card content-->
                    <div class="card-body">
                        <!-- List group links -->
                        <div class="list-group list-group-flush">
                            <a class="list-group-item list-group-item-action waves-effect">Sales
                                <span class="badge badge-success badge-pill pull-right">22%
                           <i class="fas fa-arrow-up ml-1"></i>
                           </span>
                            </a>
                            <a class="list-group-item list-group-item-action waves-effect">Traffic
                                <span class="badge badge-danger badge-pill pull-right">5%
                           <i class="fas fa-arrow-down ml-1"></i>
                           </span>
                            </a>
                            <a class="list-group-item list-group-item-action waves-effect">Orders
                                <span class="badge badge-primary badge-pill pull-right">14</span>
                            </a>
                            <a class="list-group-item list-group-item-action waves-effect">Issues
                                <span class="badge badge-primary badge-pill pull-right">123</span>
                            </a>
                            <a class="list-group-item list-group-item-action waves-effect">Messages
                                <span class="badge badge-primary badge-pill pull-right">8</span>
                            </a>
                        </div>
                        <!-- List group links -->
                    </div>
                </div>
                <!--/.Card-->
            </div>
            <!--Grid column-->
        </div>
        <!--Grid row-->
        <!--Grid row-->
        <div class="row wow fadeIn">
            <!--Grid column-->
            <div class="col-md-12 mb-4">
                <!--Card-->
                <div class="card">
                    <!--Card content-->
                    <div class="card-body">
                        <!-- Header and Actions -->
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h5 class="mb-0">Hospital Details</h5>
                            <!-- Actions -->
                            <div class="d-flex align-items-center">
                                <form class="d-flex align-items-center" onsubmit="fetchHospitalData(0); return false;">
                                    <!-- Search input -->
                                    <input type="search" id="hospitalSearchFilter" placeholder="Search..." aria-label="Search" class="form-control mr-2">
                                    <button class="btn btn-secondary btn-sm teal-color-button" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </form>
                                <!-- Add Hospital Button -->
                                <button class="btn btn-secondary btn-sm ml-3 teal-color-button" style="color: #0b2e13" id="addRowButton" data-toggle="modal" data-target="#addHospitalModal">Add Hospital</button>
                            </div>
                        </div>
                        <!-- Responsive Table -->
                        <div class="table-responsive">
                            <table class="table table-hover wow animate__animated animate__fadeIn" id="hospitalTable">
                                <!-- Table head -->
                                <thead class="blue-grey lighten-4">
                                <tr>
                                    <th>Name</th>
                                    <th>Address</th>
                                    <th>Type</th>
                                    <th>Contact Number</th>
                                    <th>Coverage</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <!-- Table head -->
                                <!-- Table body -->
                                <tbody>
                                <!-- Dynamic rows will be appended here -->
                                </tbody>
                                <!-- Table body -->
                            </table>
                        </div>

                        <div id="paginationControls" class="container-fluid pagination-controls">
                            <i id="prevPage" class="fas fa-chevron-left" onclick="changePage(currentPage - 1)" style="cursor: pointer;"></i>
                            <i id="nextPage" class="fas fa-chevron-right float-right" onclick="changePage(currentPage + 1)" style="cursor: pointer;"></i>
                        </div>
                        <!-- Responsive Table -->
                    </div>
                </div>
                <!--/.Card-->
            </div>
        </div>

        <div class="row wow fadeIn">
            <!--Grid column-->
            <div class="col-md-12 mb-4">
                <!--Card-->
                <div class="card">
                    <!--Card content-->
                    <div class="card-body">
                        <!-- Header and Actions -->
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h5 class="mb-0">Agent Details</h5>
                            <!-- Actions -->
                            <div class="d-flex align-items-center">
                                <form class="d-flex align-items-center" onsubmit="fetchAgentData(0); return false;">
                                    <!-- Search input -->
                                    <input type="search" id="agentSearchFilter" placeholder="Search..." aria-label="Search" class="form-control mr-2">
                                    <button class="btn btn-secondary btn-sm teal-color-button" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </form>
                                <!-- Add Agent Button -->
                                <button class="btn btn-secondary btn-sm ml-3 teal-color-button" id="addAgentButton" data-toggle="modal" data-target="#addAgentModal">Add Agent</button>
                            </div>
                        </div>
                        <!-- Responsive Table -->
                        <div class="table-responsive">
                            <table class="table table-hover wow animate__animated animate__fadeIn" id="agentTable">
                                <!-- Table head -->
                                <thead class="blue-grey lighten-4">
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Contact Number</th>
                                    <th>Address</th>
                                    <th>Identity Type</th>
                                    <th>Identity Number</th>
                                    <th>Active</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <!-- Table head -->
                                <!-- Table body -->
                                <tbody>
                                <!-- Dynamic rows will be appended here -->
                                </tbody>
                                <!-- Table body -->
                            </table>
                        </div>

                        <div id="agentPaginationControls" class="container-fluid pagination-controls">
                            <i id="prevPageAgent" class="fas fa-chevron-left" onclick="changeAgentPage(currentAgentPage - 1)" style="cursor: pointer;"></i>
                            <i id="nextPageAgent" class="fas fa-chevron-right float-right" onclick="changeAgentPage(currentAgentPage + 1)" style="cursor: pointer;"></i>
                        </div>
                        <!-- Responsive Table -->
                    </div>
                </div>
                <!--/.Card-->
            </div>
        </div>

        <!--Grid row-->
        <div class="row wow fadeIn">
            <!--Grid column-->
            <div class="col-md-6 mb-4">
                <!--Card-->
                <div class="card">
                    <!--Section: Modals-->
                    <section>
                        <!--Modal: Login / Register Form Demo-->
                        <div class="modal fade" id="addHospitalModal" tabindex="-1" role="dialog" aria-labelledby="addHospitalModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="addHospitalModalLabel">Add new hospital</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="addHospitalForm">
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="name" name="name" class="form-control form-control-lg" required />
                                                <label class="form-label" for="name">Full name</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="address" name="address" class="form-control form-control-lg" required />
                                                <label class="form-label" for="address">Address</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="number" name="number" class="form-control form-control-lg" required />
                                                <label class="form-label" for="number">Contact number</label>
                                            </div>
                                            <!--<div class="pt-1 mb-4">
                                                <button id="submitButton" class="btn btn-secondary btn-lg btn-block waves-effect waves-light" data-mdb-button-init data-mdb-ripple-init
                                                        type="button">Submit</button>
                                            </div>-->
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary btn-md ml-3 waves-effect waves-light teal-color-button" data-dismiss="modal">Close</button>
                                                <button type="button" id="addHospitalSubmitBtn" class="btn btn-secondary btn-md ml-3 waves-effect waves-light teal-color-button">Save changes</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Add agent modal-->
                        <div class="modal fade" id="addAgentModal" tabindex="-1" role="dialog" aria-labelledby="addAgentModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="addAgentModalLabel">Add new Agent</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="addAgentForm">
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="agentName" name="agentName" class="form-control form-control-lg" required />
                                                <label class="form-label" for="agentName">Full name</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="agentAddress" name="agentAddress" class="form-control form-control-lg" required />
                                                <label class="form-label" for="agentAddress">Address</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="agentNumber" name="agentNumber" class="form-control form-control-lg" required />
                                                <label class="form-label" for="agentNumber">Contact number</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="agentEmail" name="agentEmail" class="form-control form-control-lg" required />
                                                <label class="form-label" for="agentEmail">Email address</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="agentIdentityType" name="agentIdentityType" class="form-control form-control-lg" required />
                                                <label class="form-label" for="agentIdentityType">Identity type</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="agentIdentityNumber" name="agentIdentityNumber" class="form-control form-control-lg" required />
                                                <label class="form-label" for="agentIdentityNumber">Identity number</label>
                                            </div>
                                            <!--<div class="pt-1 mb-4">
                                                <button id="submitButton" class="btn btn-secondary btn-lg btn-block waves-effect waves-light" data-mdb-button-init data-mdb-ripple-init
                                                        type="button">Submit</button>
                                            </div>-->
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary btn-md ml-3 waves-effect waves-light teal-color-button" data-dismiss="modal">Close</button>
                                                <button type="button" id="addAgentSubmitBtn" class="btn btn-secondary btn-md ml-3 waves-effect waves-light teal-color-button">Save changes</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="modal fade" id="editHospitalModal" tabindex="-1" role="dialog" aria-labelledby="editHospitalModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="editHospitalModalLabel">Add new hospital</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="editHospitalModalForm">
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="editHospitalName" name="editHospitalName" class="form-control form-control-lg" required />
                                                <label class="form-label" for="editHospitalName">Full name</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="editHospitalAddress" name="editHospitalAddress" class="form-control form-control-lg" required />
                                                <label class="form-label" for="editHospitalAddress">Address</label>
                                            </div>
                                            <div data-mdb-input-init class="form-outline mb-4">
                                                <input type="text" id="editHospitalNumber" name="editHospitalNumber" class="form-control form-control-lg" required />
                                                <label class="form-label" for="editHospitalNumber">Contact number</label>
                                            </div>
                                            <!--<div class="pt-1 mb-4">
                                                <button id="submitButton" class="btn btn-secondary btn-lg btn-block waves-effect waves-light" data-mdb-button-init data-mdb-ripple-init
                                                        type="button">Submit</button>
                                            </div>-->
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary btn-md ml-3 waves-effect waves-light teal-color-button" data-dismiss="modal">Close</button>
                                                <button type="button" id="editHospitalSubmitBtn" class="btn btn-secondary btn-md ml-3 waves-effect waves-light teal-color-button">Save changes</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <!--/.Card-->
            </div>
            <!--Grid column-->
        </div>
        <!--Grid row-->

        <!--Modal Form Login with Avatar Demo-->
        <div class="modal fade" id="agentStatsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog cascading-modal modal-avatar modal-lg" role="document">
                <!--Content-->
                <div class="modal-content">

                    <!--Header-->
                    <div class="modal-header">
                        <img src="https://mdbootstrap.com/img/Photos/Avatars/img%20%281%29.jpg" class="rounded-circle img-responsive"
                             alt="Avatar photo">
                    </div>
                    <!--Body-->
                    <div class="modal-body text-center mb-1">

                        <h5 class="mt-1 mb-2">Maria Doe</h5>

                        <div class="table-responsive">
                            <table class="table table-hover wow animate__animated animate__fadeIn" id="agentStatsTable">
                                <!-- Table head -->
                                <thead class="blue-grey lighten-4">
                                <tr>
                                    <th>Name</th>
                                    <th>Date</th>
                                    <th>Card Number</th>
                                    <th>Contact Number</th>
                                </tr>
                                </thead>
                                <!-- Table head -->
                                <!-- Table body -->
                                <tbody>
                                <!-- Dynamic rows will be appended here -->
                                </tbody>
                                <!-- Table body -->
                            </table>
                        </div>
                    </div>

                </div>
                <!--/.Content-->
            </div>
        </div>


    </div>
</main>
<!--Main layout-->
<!--Footer-->
<footer class="page-footer text-center font-small primary-color-dark darken-2 mt-4 wow fadeIn">
    <!--Call to action-->
    <div class="pt-4">
        <a class="btn btn-outline-white" href="https://www.google.com" target="_blank"
           role="button">Contact Support
            <i class="fas fa-download ml-2"></i>
        </a>
        <a class="btn btn-outline-white" href="https://www.google.com" target="_blank" role="button">Report Issue
            <i class="fas fa-graduation-cap ml-2"></i>
        </a>
    </div>
    <!--/.Call to action-->
    <hr class="my-4">
    <!-- Social icons -->
    <div class="pb-4">
        <a href="https://www.facebook.com/mdbootstrap" target="_blank">
            <i class="fab fa-facebook-f mr-3"></i>
        </a>
        <a href="https://twitter.com/MDBootstrap" target="_blank">
            <i class="fab fa-twitter mr-3"></i>
        </a>
        <a href="https://www.youtube.com/watch?v=7MUISDJ5ZZ4" target="_blank">
            <i class="fab fa-youtube mr-3"></i>
        </a>
        <a href="https://plus.google.com/u/0/b/107863090883699620484" target="_blank">
            <i class="fab fa-google-plus mr-3"></i>
        </a>
        <a href="https://dribbble.com/mdbootstrap" target="_blank">
            <i class="fab fa-dribbble mr-3"></i>
        </a>
        <a href="https://pinterest.com/mdbootstrap" target="_blank">
            <i class="fab fa-pinterest mr-3"></i>
        </a>
        <a href="https://github.com/mdbootstrap/bootstrap-material-design" target="_blank">
            <i class="fab fa-github mr-3"></i>
        </a>
        <a href="http://codepen.io/mdbootstrap/" target="_blank">
            <i class="fab fa-codepen mr-3"></i>
        </a>
    </div>
    <!-- Social icons -->
    <!--Copyright-->
    <div class="footer-copyright py-3">
        © 2019 Copyright:
        <a href="https://mdbootstrap.com/education/bootstrap/" target="_blank"> MDBootstrap.com </a>
    </div>
    <!--/.Copyright-->
</footer>

<!-- Toast notification -->
<div class="toast-container"></div>
<!-- Loader -->
<div id="loader" class="loader">
    <div class="spinner-border" role="status">
        <span class="visually-hidden"></span>
    </div>
</div>


<!--/.Footer-->
<!-- SCRIPTS -->
<!-- JQuery -->
<script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="/js/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="/js/mdb.min.js"></script>
<!-- Initializations -->
<script type="text/javascript">
    // Animations initialization
    new WOW().init();

</script>
<!-- Charts -->
<script>
    // Line
    var ctx = document.getElementById("myChart").getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ["March", "April", "May", "June", "July", "August"],
            datasets: [{
                label: 'Number of customers in last 6 months',
                data: [200, 120, 115, 100, 200, 150],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });

    //pie
    var ctxP = document.getElementById("pieChart").getContext('2d');
    var myPieChart = new Chart(ctxP, {
        type: 'pie',
        data: {
            labels: ["Red", "Green", "Yellow", "Grey", "Dark Grey"],
            datasets: [{
                data: [300, 50, 100, 40, 120],
                backgroundColor: ["#F7464A", "#46BFBD", "#FDB45C", "#949FB1", "#4D5360"],
                hoverBackgroundColor: ["#FF5A5E", "#5AD3D1", "#FFC870", "#A8B3C5", "#616774"]
            }]
        },
        options: {
            responsive: true,
            legend: false
        }
    });


</script>
<script>
    function getJwtToken() {
        return localStorage.getItem('jwtToken');
    }
    function fetchWithAuth(url, options = {}) {
        const token = getJwtToken();
        if (token) {
            options.headers = {
                ...options.headers,
                'Authorization': `Bearer ${token}`,
            };
        }
        return fetch(url, options);
    }
    let currentPage = 0;
    const pageSize = 5; // Number of items per page
    function fetchHospitalData(page = 0) {
        const filter = document.getElementById('hospitalSearchFilter').value.trim(); // Get the filter input value
        // Construct the URL with query parameters
        let url = `/get-hospitals?page=${page}&size=${pageSize}`;
        if (filter) {
            url += `&filter=${encodeURIComponent(filter)}`; // Add the filter parameter if it's not empty
        }
        fetchWithAuth(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                const tableBody = document.querySelector('#hospitalTable tbody');
                tableBody.innerHTML = ''; // Clear any existing rows

                // Append rows to the table
                data.content.forEach(hospital => {
                    const row = document.createElement('tr');
                    console.log(hospital.id);
                    row.innerHTML = `
                    <td>${hospital.name}</td>
                    <td>${hospital.address}</td>
                    <td>${hospital.type}</td>
                    <td>${hospital.phoneNumber}</td>
                    <td>${hospital.coverage ? 'Yes' : 'No'}</td>
                    <td>
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary dropdown-toggle btn-sm teal-color-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Actions
                            </button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="#" onclick="editRow(${hospital.id})">Edit</a>
                                <a class="dropdown-item" href="#" onclick="deleteRow('${hospital.id}'); return false;">Delete</a>
                            </div>
                        </div>
                    </td>
                `;
                    tableBody.appendChild(row);
                });

                // Update pagination controls
                updatePaginationControls(data);
            })
            .catch(error => {
                console.error('Error fetching hospital data:', error);
            });
    }
    function updatePaginationControls(data) {
        const prevPageIcon = document.getElementById('prevPage');
        const nextPageIcon = document.getElementById('nextPage');

        // Enable/disable previous button
        if (data.pageable.pageNumber > 0) {
            prevPageIcon.classList.remove('disabled');
            prevPageIcon.onclick = function() { changePage(data.pageable.pageNumber - 1); };
            prevPageIcon.style.cursor = 'pointer';
        } else {
            prevPageIcon.classList.add('disabled');
            prevPageIcon.onclick = null;
            prevPageIcon.style.cursor = 'default';
        }

        // Enable/disable next button
        if (data.pageable.pageNumber < data.totalPages - 1) {
            nextPageIcon.classList.remove('disabled');
            nextPageIcon.onclick = function() { changePage(data.pageable.pageNumber + 1); };
            nextPageIcon.style.cursor = 'pointer';
        } else {
            nextPageIcon.classList.add('disabled');
            nextPageIcon.onclick = null;
            nextPageIcon.style.cursor = 'default';
        }
    }

    function changePage(page) {
        currentPage = page;
        fetchHospitalData(page);
    }
    let currentAgentPage = 0;
    const agentPageSize = 5; // Number of items per page
    function fetchAgentData(page =0) {
        const filter = document.getElementById('agentSearchFilter').value.trim(); // Get the filter input value
        // Construct the URL with query parameters
        let url = `/list-agent?page=${page}&size=${agentPageSize}`;
        if (filter) {
            url += `&filter=${encodeURIComponent(filter)}`; // Add the filter parameter if it's not empty
        }
        fetchWithAuth(url) // Replace with your API endpoint
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                const tableBody = document.querySelector('#agentTable tbody');
                tableBody.innerHTML = ''; // Clear any existing rows
                data.body.forEach(agent => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                             <td>${agent.name}</td>
                             <td>${agent.email}</td>
                             <td>${agent.phoneNumber}</td>
                             <td>${agent.address}</td>
                             <td>${agent.identityType}</td>
                             <td>${agent.identityNumber}</td>
                             <td>${agent.active ? 'Yes' : 'No'}</td>
                             <td>
                             <div class="btn-group">
                                 <button type="button" class="btn btn-secondary dropdown-toggle btn-sm teal-color-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                     Actions
                                 </button>
                                 <div class="dropdown-menu">
                                     <a class="dropdown-item" href="#" onclick="editRow(${agent.id})">Edit</a>
                                     <a class="dropdown-item" href="#" onclick="fetchAgentStats('${agent.id}'); return false;">Stats</a>
                                     <a class="dropdown-item" href="#" onclick="deleteAgent('${agent.id}'); return false;">Delete</a>
                                 </div>
                             </div>
                         </td>
                         `;
                    tableBody.appendChild(row);
                    updateAgentPaginationControls(data);
                });
            })
            .catch(error => {
                console.error('Error fetching agent data:', error);
            });
    }

    function updateAgentPaginationControls(data) {
        const prevPageIcon = document.getElementById('prevPageAgent');
        const nextPageIcon = document.getElementById('nextPageAgent');

        // Enable/disable previous button
        if (data.pageable.pageNumber > 0) {
            prevPageIcon.classList.remove('disabled');
            prevPageIcon.onclick = function() { changeAgentPage(data.pageable.pageNumber - 1); };
            prevPageIcon.style.cursor = 'pointer';
        } else {
            prevPageIcon.classList.add('disabled');
            prevPageIcon.onclick = null;
            prevPageIcon.style.cursor = 'default';
        }

        // Enable/disable next button
        if (data.pageable.pageNumber < data.totalPages - 1) {
            nextPageIcon.classList.remove('disabled');
            nextPageIcon.onclick = function() { changeAgentPage(data.pageable.pageNumber + 1); };
            nextPageIcon.style.cursor = 'pointer';
        } else {
            nextPageIcon.classList.add('disabled');
            nextPageIcon.onclick = null;
            nextPageIcon.style.cursor = 'default';
        }
    }

    function changeAgentPage(page) {
        currentAgentPage = page;
        fetchAgentData(page);
    }

    document.getElementById('addHospitalSubmitBtn').addEventListener('click', function() {
        // Get form values
        const name = document.getElementById('name').value;
        const address = document.getElementById('address').value;
        const number = document.getElementById('number').value;

        // Prepare JSON data
        const hospitalData = {
            name: name,
            address: address,
            phoneNumber: number,
            type: 'Hospital'
        };

        // Make fetch API call
        fetchWithAuth('/add-hospital', { // Replace with your API endpoint
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(hospitalData)
        })
            .then(response => {
                // Check if response is ok (status in the range 200-299)
                return response.json().then(data => {
                    if (!response.ok) {
                        // If response is not ok, throw an error with the body message
                        throw new Error(data.body || 'Something went wrong');
                    }
                    return data; // Return the data for further processing
                });
            })
            .then(data => {
                // Handle success response
                console.log('Hospital details added successfully:', data);
                fetchHospitalData(0);
                document.getElementById('addHospitalForm').reset();
                $('.modal').modal('hide'); // Assuming you are using jQuery for modal
                showToast(data.body); // Use the success message from API response
            })
            .catch(error => {
                // Handle error response
                console.error('Failed to add hospital details:', error);
                showToast(error.message, 'danger'); // Use the error message from API response
            });
    });


    document.getElementById('addAgentSubmitBtn').addEventListener('click', function() {
        document.getElementById('loader').classList.add('active');

        // Get form values
        const name = document.getElementById('agentName').value;
        const address = document.getElementById('agentAddress').value;
        const number = document.getElementById('agentNumber').value;
        const email = document.getElementById('agentEmail').value;
        const identityType = document.getElementById('agentIdentityType').value;
        const identityNumber = document.getElementById('agentIdentityNumber').value;

        // Prepare JSON data
        const agentData = {
            name: name,
            address: address,
            phoneNumber: number,
            identityType: identityType,
            identityNumber: identityNumber,
            email: email
        };

        // Make fetch API call
        fetchWithAuth('/add-agent', { // Replace with your API endpoint
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(agentData)
        })
            .then(response => {
                // Check if response is OK
                return response.json().then(data => {
                    if (!response.ok) {
                        // If response is not OK, throw an error with the body message
                        throw new Error(data.body || 'Something went wrong');
                    }
                    return data; // Return the parsed data for further processing
                });
            })
            .then(data => {
                // Handle success response
                console.log('Agent details added successfully:', data);
                fetchAgentData(0);
                document.getElementById('addAgentForm').reset();
                $('.modal').modal('hide'); // Assuming you are using jQuery for modal
                showToast(data.body); // Use the success message from API response
            })
            .catch(error => {
                // Handle error response
                console.error('Failed to add agent details:', error);
                showToast(error.message, 'danger'); // Use the error message from API response
            })
            .finally(() => {
                document.getElementById('loader').classList.remove('active');
            });
    });


    function fetchAgentStats(agentId) {
        // Call your API endpoint to fetch stats for the selected agent
        fetchWithAuth(`/agent-stats?id=${agentId}`, { // Replace with your API endpoint
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })  // Replace with your actual API endpoint
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Populate the modal with the agent's stats
                const agentStatsTableBody = document.querySelector('#agentStatsTable tbody');
                agentStatsTableBody.innerHTML = ''; // Clear any existing rows

                // Loop through the data and create rows for the table
                data.forEach(stat => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td>${stat.name}</td>
                    <td>${stat.date}</td>
                    <td>${stat.cardNumber}</td>
                    <td>${stat.contactNumber}</td>
                `;
                    agentStatsTableBody.appendChild(row);
                });

                // Open the modal
                $('#agentStatsModal').modal('show');
            })
            .catch(error => {
                console.error('Error fetching agent stats:', error);
            });
    }

    // Function to show toast notification
    function showToast(message, type = 'success') {
        const toastContainer = document.querySelector('.toast-container');
        const toast = document.createElement('div');
        toast.className = `toast align-items-center text-white bg-${type} border-0 show`;
        toast.setAttribute('role', 'alert');
        toast.setAttribute('aria-live', 'assertive');
        toast.setAttribute('aria-atomic', 'true');

        toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-mdb-dismiss="toast" aria-label="Close"></button>
                </div>
            `;

        toastContainer.appendChild(toast);

        setTimeout(() => {
            toast.classList.remove('show');
            toastContainer.removeChild(toast);
        }, 5000);
    }
    function editRow(hospitalId) {
        // Logic to handle editing a row
        console.log('Edit hospital with ID:', hospitalId);
        // Here you can redirect to an edit page or open a modal for editing
    }
    function deleteRow(hospitalId) {
        if (confirm('Are you sure you want to delete this hospital?')) {
            console.log(`Received request to delete: ${hospitalId}`);
            fetchWithAuth(`/remove-hospital?id=${hospitalId}`, { method: 'DELETE' })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(response => {
                    // Show toast notification
                    showToast(response.body);
                    // Fetch updated data
                    fetchHospitalData(0);
                })
                .catch(error => {
                    console.error('Error deleting hospital data:', error);
                });
        }
    }

    function deleteAgent(agentId) {
        if (confirm('Are you sure you want to delete this agent?')) {
            console.log(`Received request to delete: ${agentId}`);
            fetchWithAuth(`/remove-agent?id=${agentId}`, { method: 'DELETE' })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(response => {
                    // Show toast notification
                    showToast(response.body);
                    // Fetch updated data
                    fetchAgentData(0);
                })
                .catch(error => {
                    console.error('Error deleting hospital data:', error);
                    showToast("Error deleting agent.", 'danger');
                });
        }
    }

    window.addEventListener('load', fetchHospitalData(0));
    window.addEventListener('load', fetchAgentData(0));

    document.getElementById('scrollToTable').addEventListener('click', function (e) {
        e.preventDefault();
        const tableElement = document.getElementById('hospitalTable');
        const headerOffset = 150; // Adjust this value to match the height of your fixed navbar
        const elementPosition = tableElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
        });
    });
    document.getElementById('scrollToAgentTable').addEventListener('click', function (e) {
        e.preventDefault();
        const tableElement = document.getElementById('agentTable');
        const headerOffset = 150; // Adjust this value to match the height of your fixed navbar
        const elementPosition = tableElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
        });
    });
    document.getElementById('navBarHospitalScroll').addEventListener('click', function (e) {
        e.preventDefault();
        const tableElement = document.getElementById('hospitalTable');
        const headerOffset = 150; // Adjust this value to match the height of your fixed navbar
        const elementPosition = tableElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
        });
    });
    document.getElementById('navBarAgentScroll').addEventListener('click', function (e) {
        e.preventDefault();
        const tableElement = document.getElementById('agentTable');
        const headerOffset = 150; // Adjust this value to match the height of your fixed navbar
        const elementPosition = tableElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
        });
    });
    document.getElementById('addRowButton').addEventListener('click', function() {
        $('#addHospitalModal').modal('show');
    });

</script>
</body>
</html>
